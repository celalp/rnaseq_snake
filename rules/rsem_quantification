rule rsem:
    input:
        bam=os.path.join(output_directory, "alignment/{sampleID}Aligned.toTranscriptome.out.bam")
    output:
        gene=os.path.join(output_directory, "quantification/{sampleID}.genes.results"),
        isoform=os.path.join(output_directory, "quantification/{sampleID}.isoforms.results")#remove this? no use for D.E.
    params:
        forward_prob="0",
        index=config["resources"]["rsem_index"],
        max_len="1000",
        samples_dir=os.path.join(output_directory, "quantification/{sampleID}")
    threads: 15
    group: "expression"
    shell:
        """
        rsem-calculate-expression \
            --bam \
            --num-threads 15 \
            --fragment-length-max {params.max_len} \
            --no-bam-output \
            --paired-end \
            --estimate-rspd \
            --calc-ci \
            --forward-prob {params.forward_prob} \
            {input.bam} \
            {params.index} {params.samples_dir}
        """
